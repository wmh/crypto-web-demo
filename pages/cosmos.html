<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmos ç¯„ä¾‹</title>
    <link rel="stylesheet" href="../styles/common.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body>
    <div class="container">
        <h1>âš› Cosmos ç°½åèˆ‡äº¤æ˜“</h1>
        
        <nav class="nav-bar">
            <a href="../index.html">é¦–é </a>
            <a href="hash.html">é›œæ¹Šæ¼”ç®—æ³•</a>
            <a href="symmetric.html">å°ç¨±åŠ å¯†</a>
            <a href="asymmetric.html">éå°ç¨±åŠ å¯†</a>
            <a href="ethereum.html">Ethereum</a>
            <a href="bitcoin.html">Bitcoin</a>
            <a href="solana.html">Solana</a>
            <a href="cosmos.html" class="active">Cosmos</a>
                    <a href="tron.html">Tron</a>
            <a href="polkadot.html">Polkadot</a>
        </nav>

        <div class="info-box">
            <h4>âš› Cosmos ç°½åèˆ‡äº¤æ˜“</h4>
            <p>Cosmos SDK æ”¯æ´å¤šç¨®ç°½åæ¼”ç®—æ³•ï¼šsecp256k1 (é»˜èª)ã€ed25519ã€sr25519ã€‚ä½¿ç”¨ Bech32 åœ°å€ç·¨ç¢¼ï¼Œä¸åŒéˆæœ‰ä¸åŒå‰ç¶´ï¼ˆcosmosã€osmoã€juno ç­‰ï¼‰ã€‚</p>
        </div>

        <div class="demo-section">
            <h3>1. ç”Ÿæˆ Cosmos éŒ¢åŒ…</h3>
            
            <div class="code-section">
                <div class="code-header">
                    <h4>ğŸ’» JavaScript ç¯„ä¾‹</h4>
                    <button class="copy-btn" onclick="copyCode(this, 'cosmos-wallet-code')">è¤‡è£½</button>
                </div>
                <pre><code id="cosmos-wallet-code" class="language-javascript">// Cosmos ä½¿ç”¨ secp256k1 (èˆ‡ Bitcoin/Ethereum ç›¸åŒ)
const EC = require('elliptic').ec;
const ec = new EC('secp256k1');

// ç”Ÿæˆå¯†é‘°å°
const keyPair = ec.genKeyPair();
const privateKey = keyPair.getPrivate('hex');
const publicKey = keyPair.getPublic(true, 'hex');

// ç”Ÿæˆ Bech32 åœ°å€
// 1. SHA-256 å…¬é‘°
const sha256 = CryptoJS.SHA256(CryptoJS.enc.Hex.parse(publicKey));
// 2. RIPEMD-160
const hash = CryptoJS.RIPEMD160(sha256).toString();
// 3. Bech32 ç·¨ç¢¼ (å‰ç¶´: cosmos, osmo, juno ç­‰)
const address = bech32.encode('cosmos', bech32.toWords(hash));</code></pre>
            </div>

            <button onclick="generateCosmosWallet()">ç”Ÿæˆ Cosmos éŒ¢åŒ…</button>
            <div id="cosmosWalletOutput" class="output"></div>
        </div>

        <div class="demo-section">
            <h3>2. ç°½ç½²è¨Šæ¯</h3>
            
            <div class="code-section">
                <div class="code-header">
                    <h4>ğŸ’» JavaScript ç¯„ä¾‹</h4>
                    <button class="copy-btn" onclick="copyCode(this, 'cosmos-sign-code')">è¤‡è£½</button>
                </div>
                <pre><code id="cosmos-sign-code" class="language-javascript">// Cosmos è¨Šæ¯ç°½å
const message = "Cosmos Hub";
const msgHash = CryptoJS.SHA256(message).toString();

// ç°½ç½²
const signature = keyPair.sign(msgHash);
console.log("ç°½å r:", signature.r.toString('hex'));
console.log("ç°½å s:", signature.s.toString('hex'));

// é©—è­‰
const valid = keyPair.verify(msgHash, signature);
console.log("é©—è­‰çµæœ:", valid);

// Cosmos SDK ä½¿ç”¨ Amino æˆ– Protobuf ç·¨ç¢¼è¨Šæ¯</code></pre>
            </div>

            <div class="input-group">
                <label>è¨Šæ¯ï¼š</label>
                <input type="text" id="cosmosMessage" value="Cosmos Hub" placeholder="è¼¸å…¥è¦ç°½ç½²çš„è¨Šæ¯">
            </div>
            <button onclick="signCosmosMessage()">âœï¸ ç°½ç½²è¨Šæ¯</button>
            <button onclick="verifyCosmosMessage()">âœ… é©—è­‰ç°½å</button>
            <div id="cosmosMessageOutput" class="output"></div>
        </div>

        <div class="demo-section">
            <h3>3. å»ºç«‹ä¸¦ç°½ç½²è½‰å¸³äº¤æ˜“</h3>
            
            <div class="code-section">
                <div class="code-header">
                    <h4>ğŸ’» JavaScript ç¯„ä¾‹</h4>
                    <button class="copy-btn" onclick="copyCode(this, 'cosmos-tx-code')">è¤‡è£½</button>
                </div>
                <pre><code id="cosmos-tx-code" class="language-javascript">// Cosmos SDK äº¤æ˜“çµæ§‹
const txBody = {
    messages: [{
        '@type': '/cosmos.bank.v1beta1.MsgSend',
        from_address: 'cosmos1...',
        to_address: 'cosmos1...',
        amount: [{
            denom: 'uatom',
            amount: '100000' // 0.1 ATOM (1 ATOM = 1,000,000 uatom)
        }]
    }],
    memo: '',
    timeout_height: '0',
    extension_options: [],
    non_critical_extension_options: []
};

// ç°½ç½²è³‡è¨Š
const authInfo = {
    signer_infos: [{
        public_key: publicKey,
        mode_info: { single: { mode: 'SIGN_MODE_DIRECT' } },
        sequence: '0'
    }],
    fee: {
        amount: [{ denom: 'uatom', amount: '5000' }],
        gas_limit: '200000'
    }
};</code></pre>
            </div>

            <div class="input-group">
                <label>æ”¶æ¬¾åœ°å€ï¼š</label>
                <input type="text" id="cosmosToAddress" value="cosmos1..." placeholder="cosmos1...">
            </div>
            <div class="input-group">
                <label>é‡‘é¡ (ATOM)ï¼š</label>
                <input type="text" id="cosmosAmount" value="0.1" placeholder="0.1">
            </div>
            <button onclick="createCosmosTransaction()">ğŸ“ å»ºç«‹ä¸¦ç°½ç½²äº¤æ˜“</button>
            <div id="cosmosTxOutput" class="output"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/elliptic/6.5.4/elliptic.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="../scripts/cosmos.js"></script>
    <script>
        function copyCode(btn, codeId) {
            const code = document.getElementById(codeId).textContent;
            navigator.clipboard.writeText(code).then(() => {
                btn.textContent = 'å·²è¤‡è£½ï¼';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'è¤‡è£½';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }
    </script>
</body>
</html>
