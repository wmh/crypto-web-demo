<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ethereum ç¯„ä¾‹</title>
    <link rel="stylesheet" href="../styles/common.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body>
    <div class="container">
        <h1>âŸ  Ethereum ç°½åèˆ‡äº¤æ˜“</h1>
        
        <nav class="nav-bar">
            <a href="../index.html">é¦–é </a>
            <a href="hash.html">é›œæ¹Šæ¼”ç®—æ³•</a>
            <a href="symmetric.html">å°ç¨±åŠ å¯†</a>
            <a href="asymmetric.html">éå°ç¨±åŠ å¯†</a>
            <a href="ethereum.html" class="active">Ethereum</a>
            <a href="bitcoin.html">Bitcoin</a>
            <a href="solana.html">Solana</a>
            <a href="cosmos.html">Cosmos</a>
                    <a href="tron.html">Tron</a>
            <a href="polkadot.html">Polkadot</a>
        </nav>

        <div class="info-box">
            <h4>âŸ  Ethereum ç°½åèˆ‡äº¤æ˜“</h4>
            <p>Ethereum ä½¿ç”¨ ECDSA (secp256k1) é€²è¡Œç°½åï¼ŒKeccak-256 é€²è¡Œé›œæ¹Šã€‚æ”¯æ´ EIP-155 (é˜²é‡æ”¾æ”»æ“Š)ã€EIP-1559 (æ–°è²»ç”¨æ©Ÿåˆ¶)ã€EIP-712 (çµæ§‹åŒ–è³‡æ–™ç°½å)ã€‚</p>
        </div>

        <div class="demo-section">
            <h3>1. ç”ŸæˆéŒ¢åŒ…</h3>
            
            <div class="code-section">
                <div class="code-header">
                    <h4>ğŸ’» JavaScript ç¯„ä¾‹</h4>
                    <button class="copy-btn" onclick="copyCode(this, 'eth-wallet-code')">è¤‡è£½</button>
                </div>
                <pre><code id="eth-wallet-code" class="language-javascript">// ä½¿ç”¨ ethers.js ç”Ÿæˆ Ethereum éŒ¢åŒ…
const { ethers } = require('ethers');

// ç”Ÿæˆéš¨æ©ŸéŒ¢åŒ…
const wallet = ethers.Wallet.createRandom();
console.log("åŠ©è¨˜è©:", wallet.mnemonic.phrase);
console.log("ç§é‘°:", wallet.privateKey);
console.log("åœ°å€:", wallet.address);

// å¾ç§é‘°æ¢å¾©éŒ¢åŒ…
const recoveredWallet = new ethers.Wallet(privateKey);

// å¾åŠ©è¨˜è©æ¢å¾©éŒ¢åŒ…
const walletFromMnemonic = ethers.Wallet.fromMnemonic(mnemonic);</code></pre>
            </div>

            <button onclick="generateEthWallet()">ç”Ÿæˆ Ethereum éŒ¢åŒ…</button>
            <div id="ethWalletOutput" class="output"></div>
        </div>

        <div class="demo-section">
            <h3>2. ç°½ç½²è¨Šæ¯ (Personal Sign)</h3>
            
            <div class="code-section">
                <div class="code-header">
                    <h4>ğŸ’» JavaScript ç¯„ä¾‹</h4>
                    <button class="copy-btn" onclick="copyCode(this, 'eth-sign-code')">è¤‡è£½</button>
                </div>
                <pre><code id="eth-sign-code" class="language-javascript">// Personal Sign
const message = "Welcome to Ethereum!";
const signature = await wallet.signMessage(message);
console.log("ç°½å:", signature);

// é©—è­‰ç°½åä¸¦æ¢å¾©åœ°å€
const recoveredAddress = ethers.verifyMessage(message, signature);
console.log("æ¢å¾©çš„åœ°å€:", recoveredAddress);
console.log("æ˜¯å¦åŒ¹é…:", recoveredAddress === wallet.address);</code></pre>
            </div>

            <div class="input-group">
                <label>è¨Šæ¯ï¼š</label>
                <input type="text" id="ethMessage" value="Welcome to Ethereum!" placeholder="è¼¸å…¥è¦ç°½ç½²çš„è¨Šæ¯">
            </div>
            <button onclick="signEthMessage()">âœï¸ ç°½ç½²è¨Šæ¯</button>
            <button onclick="verifyEthMessage()">âœ… é©—è­‰ç°½å</button>
            <div id="ethMessageOutput" class="output"></div>
        </div>

        <div class="demo-section">
            <h3>3. EIP-712 çµæ§‹åŒ–è³‡æ–™ç°½å</h3>
            <p>ç”¨æ–¼ DApp æˆæ¬Šã€NFT äº¤æ˜“ç­‰å ´æ™¯</p>
            
            <div class="code-section">
                <div class="code-header">
                    <h4>ğŸ’» JavaScript ç¯„ä¾‹</h4>
                    <button class="copy-btn" onclick="copyCode(this, 'eip712-code')">è¤‡è£½</button>
                </div>
                <pre><code id="eip712-code" class="language-javascript">// EIP-712 çµæ§‹åŒ–è³‡æ–™ç°½å
const domain = {
    name: 'My DApp',
    version: '1',
    chainId: 1,
    verifyingContract: '0x...'
};

const types = {
    Mail: [
        { name: 'from', type: 'address' },
        { name: 'to', type: 'address' },
        { name: 'contents', type: 'string' }
    ]
};

const value = {
    from: wallet.address,
    to: '0x...',
    contents: 'Hello, EIP-712!'
};

const signature = await wallet.signTypedData(domain, types, value);</code></pre>
            </div>

            <button onclick="signEIP712()">âœï¸ ç°½ç½² EIP-712 è³‡æ–™</button>
            <div id="eip712Output" class="output"></div>
        </div>

        <div class="demo-section">
            <h3>4. å»ºç«‹ä¸¦ç°½ç½²äº¤æ˜“ (EIP-1559)</h3>
            
            <div class="code-section">
                <div class="code-header">
                    <h4>ğŸ’» JavaScript ç¯„ä¾‹</h4>
                    <button class="copy-btn" onclick="copyCode(this, 'eth-tx-code')">è¤‡è£½</button>
                </div>
                <pre><code id="eth-tx-code" class="language-javascript">// å»ºç«‹ EIP-1559 äº¤æ˜“
const tx = {
    to: '0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb0',
    value: ethers.parseEther('0.1'),
    chainId: 1,
    nonce: await provider.getTransactionCount(wallet.address),
    gasLimit: 21000,
    maxFeePerGas: ethers.parseUnits('50', 'gwei'),
    maxPriorityFeePerGas: ethers.parseUnits('2', 'gwei'),
    type: 2 // EIP-1559 äº¤æ˜“é¡å‹
};

// ç°½ç½²äº¤æ˜“
const signedTx = await wallet.signTransaction(tx);
console.log("å·²ç°½ç½²äº¤æ˜“:", signedTx);

// ç™¼é€äº¤æ˜“
const txResponse = await wallet.sendTransaction(tx);</code></pre>
            </div>

            <div class="input-group">
                <label>æ”¶æ¬¾åœ°å€ï¼š</label>
                <input type="text" id="ethToAddress" value="0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb0" placeholder="0x...">
            </div>
            <div class="input-group">
                <label>é‡‘é¡ (ETH)ï¼š</label>
                <input type="text" id="ethAmount" value="0.1" placeholder="0.1">
            </div>
            <button onclick="createEthTransaction()">ğŸ“ å»ºç«‹ä¸¦ç°½ç½²äº¤æ˜“</button>
            <div id="ethTxOutput" class="output"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/ethers@6.9.0/dist/ethers.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="../scripts/ethereum.js"></script>
    <script>
        function copyCode(btn, codeId) {
            const code = document.getElementById(codeId).textContent;
            navigator.clipboard.writeText(code).then(() => {
                btn.textContent = 'å·²è¤‡è£½ï¼';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'è¤‡è£½';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }
    </script>
</body>
</html>
