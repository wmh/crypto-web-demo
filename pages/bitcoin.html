<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin ç¯„ä¾‹</title>
    <link rel="stylesheet" href="../styles/common.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body>
    <div class="container">
        <h1>â‚¿ Bitcoin ç°½åèˆ‡äº¤æ˜“</h1>
        
        <nav class="nav-bar">
            <a href="../index.html">é¦–é </a>
            <a href="hash.html">é›œæ¹Šæ¼”ç®—æ³•</a>
            <a href="symmetric.html">å°ç¨±åŠ å¯†</a>
            <a href="asymmetric.html">éå°ç¨±åŠ å¯†</a>
            <a href="ethereum.html">Ethereum</a>
            <a href="bitcoin.html" class="active">Bitcoin</a>
            <a href="solana.html">Solana</a>
            <a href="cosmos.html">Cosmos</a>
                    <a href="tron.html">Tron</a>
            <a href="polkadot.html">Polkadot</a>
        </nav>

        <div class="info-box">
            <h4>â‚¿ Bitcoin ç°½åèˆ‡äº¤æ˜“</h4>
            <p>Bitcoin ä½¿ç”¨ ECDSA (secp256k1)ï¼Œåœ°å€é€šé SHA-256 å’Œ RIPEMD-160 é›œæ¹Šç”Ÿæˆã€‚æ”¯æ´å¤šç¨®åœ°å€æ ¼å¼ï¼šP2PKH (Legacy), P2SH, P2WPKH (SegWit), P2TR (Taproot)ã€‚</p>
        </div>

        <div class="demo-section">
            <h3>1. ç”Ÿæˆæ¯”ç‰¹å¹£éŒ¢åŒ…ï¼ˆæ”¯æ´å¤šç¨®åœ°å€æ ¼å¼ï¼‰</h3>
            
            <div class="code-section">
                <div class="code-header">
                    <h4>ğŸ’» JavaScript ç¯„ä¾‹</h4>
                    <button class="copy-btn" onclick="copyCode(this, 'btc-wallet-code')">è¤‡è£½</button>
                </div>
                <pre><code id="btc-wallet-code" class="language-javascript">// ä½¿ç”¨ elliptic ç”Ÿæˆ Bitcoin å¯†é‘°å°
const EC = require('elliptic').ec;
const ec = new EC('secp256k1');

// ç”Ÿæˆå¯†é‘°å°
const keyPair = ec.genKeyPair();
const privateKey = keyPair.getPrivate('hex');
const publicKey = keyPair.getPublic(true, 'hex'); // å£“ç¸®æ ¼å¼

// ç”Ÿæˆåœ°å€ (ç°¡åŒ–æµç¨‹)
// 1. SHA-256(å…¬é‘°)
const sha256 = CryptoJS.SHA256(CryptoJS.enc.Hex.parse(publicKey));
// 2. RIPEMD-160(SHA-256çµæœ)
const pubKeyHash = CryptoJS.RIPEMD160(sha256).toString();

// P2PKH (Legacy): 1...
// P2WPKH (SegWit): bc1q...</code></pre>
            </div>

            <button onclick="generateBtcWallet()">ç”Ÿæˆ Bitcoin éŒ¢åŒ…</button>
            <div id="btcWalletOutput" class="output"></div>
        </div>

        <div class="demo-section">
            <h3>2. ç°½ç½²è¨Šæ¯ (Bitcoin Message Signing)</h3>
            
            <div class="code-section">
                <div class="code-header">
                    <h4>ğŸ’» JavaScript ç¯„ä¾‹</h4>
                    <button class="copy-btn" onclick="copyCode(this, 'btc-sign-code')">è¤‡è£½</button>
                </div>
                <pre><code id="btc-sign-code" class="language-javascript">// Bitcoin è¨Šæ¯ç°½å
const message = "Bitcoin signed message";
const prefix = "Bitcoin Signed Message:\n";
const fullMessage = prefix + message;

// é›œæ¹Šè¨Šæ¯
const msgHash = CryptoJS.SHA256(fullMessage).toString();

// ç°½ç½²
const signature = keyPair.sign(msgHash);
console.log("ç°½å r:", signature.r.toString('hex'));
console.log("ç°½å s:", signature.s.toString('hex'));

// é©—è­‰
const valid = keyPair.verify(msgHash, signature);
console.log("é©—è­‰çµæœ:", valid);</code></pre>
            </div>

            <div class="input-group">
                <label>è¨Šæ¯ï¼š</label>
                <input type="text" id="btcMessage" value="Bitcoin signed message" placeholder="è¼¸å…¥è¦ç°½ç½²çš„è¨Šæ¯">
            </div>
            <button onclick="signBtcMessage()">âœï¸ ç°½ç½²è¨Šæ¯</button>
            <button onclick="verifyBtcMessage()">âœ… é©—è­‰ç°½å</button>
            <div id="btcMessageOutput" class="output"></div>
        </div>

        <div class="demo-section">
            <h3>3. å»ºç«‹ä¸¦ç°½ç½²äº¤æ˜“ (P2WPKH - SegWit)</h3>
            
            <div class="code-section">
                <div class="code-header">
                    <h4>ğŸ’» JavaScript ç¯„ä¾‹</h4>
                    <button class="copy-btn" onclick="copyCode(this, 'btc-tx-code')">è¤‡è£½</button>
                </div>
                <pre><code id="btc-tx-code" class="language-javascript">// Bitcoin äº¤æ˜“çµæ§‹ï¼ˆç°¡åŒ–ï¼‰
const transaction = {
    version: 2,
    inputs: [{
        txid: 'previous_tx_hash',
        vout: 0,
        scriptSig: '', // SegWit ç‚ºç©º
        witness: [], // è¦‹è­‰è³‡æ–™
        sequence: 0xffffffff
    }],
    outputs: [{
        value: 10000, // satoshis
        scriptPubKey: 'OP_0 <pubkey_hash>' // P2WPKH
    }],
    locktime: 0
};

// ç°½ç½²äº¤æ˜“éœ€è¦å®Œæ•´çš„ bitcoinjs-lib
// æ­¤è™•ç‚ºæ¼”ç¤ºæ¦‚å¿µ</code></pre>
            </div>

            <div class="input-group">
                <label>æ”¶æ¬¾åœ°å€ï¼š</label>
                <input type="text" id="btcToAddress" value="bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh" placeholder="bc1...">
            </div>
            <div class="input-group">
                <label>é‡‘é¡ (BTC)ï¼š</label>
                <input type="text" id="btcAmount" value="0.001" placeholder="0.001">
            </div>
            <button onclick="createBtcTransaction()">ğŸ“ å»ºç«‹ä¸¦ç°½ç½²äº¤æ˜“</button>
            <div id="btcTxOutput" class="output"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/elliptic/6.5.4/elliptic.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="../scripts/bitcoin.js"></script>
    <script>
        function copyCode(btn, codeId) {
            const code = document.getElementById(codeId).textContent;
            navigator.clipboard.writeText(code).then(() => {
                btn.textContent = 'å·²è¤‡è£½ï¼';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'è¤‡è£½';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }
    </script>
</body>
</html>
